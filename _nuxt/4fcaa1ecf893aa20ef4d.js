(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{483:function(t,e,o){var content=o(610);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(23).default)("50aafe0b",content,!0,{sourceMap:!1})},609:function(t,e,o){"use strict";var n=o(483);o.n(n).a},610:function(t,e,o){(t.exports=o(22)(!1)).push([t.i,".container[data-v-a7cc81fa][data-v-4981cba2]{width:1000px;margin:0 auto;padding:20px 0}.main h2[data-v-4981cba2]{font-weight:400;font-size:22px;margin-bottom:10px}.main .fxyj[data-v-4981cba2]{font-size:12px;color:#999;margin-bottom:10px}.main .w-biaoti[data-v-4981cba2]{margin-bottom:22px}.main-form[data-v-4981cba2]{width:750px;margin-bottom:20px}.main .main-fu[data-v-4981cba2]{height:458px}.main .main-fu-c[data-v-4981cba2]{margin-bottom:22px;height:400px}.main .submit-side a[data-v-4981cba2]{color:orange}.main .w-input[data-v-4981cba2]{background-color:#fff;border-radius:4px;border:1px solid #dcdfe6;box-sizing:border-box;color:#606266;display:inline-block;font-size:inherit;height:40px;line-height:40px;padding:0 15px;width:100%}.label[data-v-4981cba2]{color:#606266}.label[data-v-4981cba2],.span[data-v-4981cba2]{font-size:14px}.button[data-v-4981cba2]{background-color:#409eff;width:65px;height:35px;cursor:pointer;color:#fff;border:none}.caogao[data-v-4981cba2]{width:200px;color:#666}.caogao .caogao-bian[data-v-4981cba2]{border:1px solid #ddd;padding:10px}.caogao .shubiao[data-v-4981cba2]{cursor:pointer;color:#000}.shubiao[data-v-4981cba2]:hover{text-decoration:underline;color:orange}.caogao-bian-conner[data-v-4981cba2]{margin-bottom:10px;font-size:14px}.caogao-xiang[data-v-4981cba2]{margin-bottom:10px;font-weight:700;color:#666}",""])},633:function(t,e,o){"use strict";o.r(e);o(85),o(32),o(33),o(56);var n,r=o(34),c=(o(55),o(84),o(17),o(83),o(9)),l=o(126);o(583);function d(object,t){var e=Object.keys(object);return Object.getOwnPropertySymbols&&e.push.apply(e,Object.getOwnPropertySymbols(object)),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(source,!0).forEach(function(e){Object(r.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}n=o(585).default;var m,h={name:"app",data:function(){return{listConner:[],form:{destCity:"",biaoti:"",nei:"",time:""},isShow:!1,config:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],["image","video"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}]]},theme:"snow",uploadImage:{url:"http://157.122.54.189:9095/upload",name:"files",uploadBefore:function(t){return!0},uploadProgress:function(t){},uploadSuccess:function(t,e){e("http://157.122.54.189:9095"+t.data[0].url)},uploadError:function(){},showProgress:!0},uploadVideo:{url:"http://157.122.54.189:9095/upload",name:"files",uploadBefore:function(t){return!0},uploadProgress:function(t){},uploadSuccess:function(t,e){e("http://localhost:1337"+t.data[0].url)},uploadError:function(){}}}}},mounted:function(){var t=this;setTimeout(function(){t.isShow=!0,t.listConner=Object(l.a)(t.$store.state.post.postInfo),t.listConner.length>5&&(t.listConner.length=5)},1e3)},methods:{queryDestSearch:(m=Object(c.a)(regeneratorRuntime.mark(function t(e,o){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.findCity(e);case 2:(n=t.sent).length>0&&(this.form.destCity=n[0].value),o(n);case 5:case"end":return t.stop()}},t,this)})),function(t,e){return m.apply(this,arguments)}),findCity:function(t){var e=this;return new Promise(function(o,n){0!=t.trim().length?e.$axios({url:"/cities",params:{name:t}}).then(function(t){var e=t.data.data.map(function(t){return t.value=t.name.replace("市",""),t});o(e)}):o([])})},handleDestSelect:function(t){this.form.destCity=t.value},dianji:function(){this.form.nei=this.$refs.vueEditor.editor.root.innerHTML;var data=new Date,t=this.$moment(data).format("YYYY-MM-DD");this.form.time=t;var e=f({},this.form);this.listConner.unshift(e),this.$store.commit("post/setpostInfo",this.listConner),this.listConner.length>5&&(this.listConner.length=5),this.form={destCity:"",biaoti:"",time:""},this.$refs.vueEditor.editor.root.innerHTML=""},fanhui:function(t){var e=f({},t).nei;this.form=f({},t),this.$refs.vueEditor.editor.root.innerHTML=e},fabu:function(){var t=this;this.form.nei=this.$refs.vueEditor.editor.root.innerHTML;var e=this.$store.state.user.userInfo.token,o=!0;if(this.form.nei=this.$refs.vueEditor.editor.root.innerHTML,"<p><br></p>"!==this.form.nei){if([{message:"请输入标题",rule:this.form.biaoti},{message:"请输入文本框内容",rule:this.form.nei},{message:"请输入搜索游玩城市",rule:this.form.destCity}].map(function(e){if(0==e.rule.length)return o=!1,setTimeout(function(){t.$message.warning(e.message)},100)}),o){var form={content:this.form.nei,title:this.form.biaoti,city:this.form.destCity};this.$axios({baseURL:"http://157.122.54.189:9095",url:"/posts",method:"POST",data:form,headers:{Authorization:"Bearer ".concat(e||"NO TOKEN")}}).then(function(e){"新增成功"==e.data.message&&(t.$message({message:"发布成功",type:"success"}),t.$router.push({path:"/post/detail"}))})}}else this.$message.warning("请输入内容!")}},components:{VueEditor:n}},v=(o(609),o(12)),component=Object(v.a)(h,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"container",attrs:{"data-v-a7cc81fa":""}},[o("el-row",{attrs:{type:"flex",justify:"space-between"}},[o("div",{staticClass:"main"},[o("h2",[t._v("发表新攻略")]),t._v(" "),o("p",{staticClass:"fxyj"},[t._v("分享你的个人游记，让更多人看到哦！")]),t._v(" "),o("form",{staticClass:"main-form"},[o("div",{staticClass:"w-biaoti"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.biaoti,expression:"form.biaoti"}],staticClass:"w-input",attrs:{type:"text",placeholder:"请输入标题"},domProps:{value:t.form.biaoti},on:{input:function(e){e.target.composing||t.$set(t.form,"biaoti",e.target.value)}}})]),t._v(" "),o("div",{staticClass:"main-fu",attrs:{id:"app"}},[t.isShow?o("VueEditor",{ref:"vueEditor",staticClass:"main-fu-c",attrs:{config:t.config},model:{value:t.form.nei,callback:function(e){t.$set(t.form,"nei",e)},expression:"form.nei"}}):t._e()],1),t._v(" "),o("div",[o("label",{staticClass:"label"},[t._v("选择城市")]),t._v(" "),o("el-autocomplete",{staticClass:"el-autocomplete",attrs:{"fetch-suggestions":t.queryDestSearch,placeholder:"请搜索游玩城市"},on:{select:t.handleDestSelect},model:{value:t.form.destCity,callback:function(e){t.$set(t.form,"destCity",e)},expression:"form.destCity"}})],1)]),t._v(" "),o("div",{staticClass:"submit-side"},[o("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.fabu}},[t._v("发布")]),t._v(" "),o("span",{staticClass:"span"},[o("span",[t._v("或者")]),t._v(" "),o("a",{attrs:{href:"javascript:;"},on:{click:t.dianji}},[t._v("保存到草稿")])])])]),t._v(" "),o("div",{staticClass:"caogao"},[o("div",{staticClass:"caogao-bian"},[o("h4",{staticClass:"caogao-xiang"},[t._v("草稿箱 ("+t._s(t.listConner.length)+")")]),t._v(" "),t._l(t.listConner,function(e,n){return o("div",{key:n,staticClass:"caogao-bian-conner"},[o("div",{staticClass:"shubiao",on:{click:function(o){return t.fanhui(e)}}},[o("span",[t._v(t._s(e.biaoti))]),t._v(" "),o("i",{staticClass:"el-icon-edit"})]),t._v(" "),o("div",[t._v(t._s(e.time))])])})],2)])])],1)},[],!1,null,"4981cba2",null);e.default=component.exports}}]);